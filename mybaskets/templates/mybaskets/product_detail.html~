{% extends "mybaskets/base.html" %}
{% block title %} Products - {{ product.name}}{% endblock %}

{% block content %}
<span vocab="http://schema.org/" typeof="Product">
    <h1>
    <span property="name">{{ product.name }}</span>
    </h1>

  
    <h2>Reviews</h2>
    {% if product.productreview_set.all|length > 0 %}
        <span rel="aggregateRating">
        <p typeof="AggregateRating">
	  Average rating
            <span property="ratingValue">{{ product.averageRating|stringformat:".1f" }}</span>
            {% with product.productreview_set.all|length as reviewCount %}
	    from <span property="reviewCount">{{ reviewCount }}
	    </span> review{{ reviewCount|pluralize }}
	    {% endwith %}
        </p>
	</span>
        <ul rel="review">
            {% for review in product.productreview_set.all %}
                <li typeof="Review">
                    <span property="reviewRating" typeof="Rating">
                        Rating:
                        <span property="ratingValue">{{ review.rating }}</span>
                        <span property="worstRating" content="0"></span>
                        <span property="bestRating" content="5"></span>
                        by
                    </span>
                    <span property="author">{{ review.user }}</span>
                    <p property="reviewBody">{{ review.comment }}</p>
                    <span property="datePublished">{{ review.date}}</span>
                </li>
            {% endfor %}
        </ul>
        <h3>Your Review</h3>
        <form action="{% url 'mybaskets:review_create' product.id %}" method="post">
            {% csrf_token %}
            Rating:
            <select name="rating" id="rating">
                <option value="5">5</option>
                <option value="4">4</option>
                <option selected value="3">3</option>
                <option value="2">2</option>
                <option value="1">1</option>
            </select><br>
            Comment: <br>
            <textarea  name="comment" id="comment" rows="4" cols="30"></textarea>
            <br>
            <input type="submit" value="Review" />
        </form>
    </div>
</span>
{% endblock %}
